{"ast":null,"code":"import React,{createContext,useEffect,useState}from\"react\";import{jsx as _jsx}from\"react/jsx-runtime\";export const ShopContext=/*#__PURE__*/createContext(null);const ShopContextProvider=props=>{const[products,setProducts]=useState([]);const getDefaultCart=()=>{let cart={};for(let i=0;i<300;i++){cart[i]=0;}return cart;};const[cartItems,setCartItems]=useState(getDefaultCart());useEffect(()=>{fetch(\"http://localhost:4000/allproducts\").then(res=>res.json()).then(data=>setProducts(data));if(localStorage.getItem(\"auth-token\")){fetch(\"http://localhost:4000/getcart\",{method:\"POST\",headers:{Accept:\"application/json\",\"auth-token\":\"\".concat(localStorage.getItem(\"auth-token\")),\"Content-Type\":\"application/json\"},body:JSON.stringify()}).then(resp=>resp.json()).then(data=>{setCartItems(data);});}},[]);const getTotalCartAmount=()=>{let totalAmount=0;for(const item in cartItems){if(cartItems[item]>0){let itemInfo=products.find(product=>product.id===Number(item));if(itemInfo&&itemInfo.new_price){totalAmount+=cartItems[item]*itemInfo.new_price;}}}return totalAmount;};const getTotalCartItems=()=>{let totalItem=0;for(const item in cartItems){if(cartItems[item]>0){totalItem+=cartItems[item];}}return totalItem;};const addToCart=itemId=>{console.log(\"Adding to cart:\",itemId);setCartItems(prev=>({...prev,[itemId]:prev[itemId]+1}));if(localStorage.getItem(\"auth-token\")){fetch(\"http://localhost:4000/addtocart\",{method:\"POST\",headers:{Accept:\"application/json\",\"auth-token\":\"\".concat(localStorage.getItem(\"auth-token\")),\"Content-Type\":\"application/json\"},body:JSON.stringify({itemId:itemId})}).then(resp=>{if(!resp.ok){throw new Error(\"HTTP error! Status: \".concat(resp.status));}return resp.json();}).then(data=>{console.log(data);if(data.success){}else{}}).catch(error=>{console.error(error);});}};const removeFromCart=itemId=>{console.log(\"Removing from cart:\",itemId);setCartItems(prev=>({...prev,[itemId]:prev[itemId]-1}));if(localStorage.getItem(\"auth-token\")){fetch(\"http://localhost:4000/removefromcart\",{method:\"POST\",headers:{Accept:\"application/json\",\"auth-token\":\"\".concat(localStorage.getItem(\"auth-token\")),\"Content-Type\":\"application/json\"},body:JSON.stringify({itemId:itemId})}).then(resp=>resp.json()).then(data=>{console.log(data);});}};const contextValue={products,getTotalCartItems,cartItems,addToCart,removeFromCart,getTotalCartAmount};return/*#__PURE__*/_jsx(ShopContext.Provider,{value:contextValue,children:props.children});};export default ShopContextProvider;","map":{"version":3,"names":["React","createContext","useEffect","useState","jsx","_jsx","ShopContext","ShopContextProvider","props","products","setProducts","getDefaultCart","cart","i","cartItems","setCartItems","fetch","then","res","json","data","localStorage","getItem","method","headers","Accept","concat","body","JSON","stringify","resp","getTotalCartAmount","totalAmount","item","itemInfo","find","product","id","Number","new_price","getTotalCartItems","totalItem","addToCart","itemId","console","log","prev","ok","Error","status","success","catch","error","removeFromCart","contextValue","Provider","value","children"],"sources":["C:/Users/thede/Deep-Cuts-and-Broken-Heart/e-commerce-frontend/src/Context/ShopContext.jsx"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\r\n\r\n\r\nexport const ShopContext = createContext(null);\r\n\r\nconst ShopContextProvider = (props) => {\r\n  const [products, setProducts] = useState([]);\r\n  const getDefaultCart = () => {\r\n    let cart = {};\r\n    for (let i = 0; i < 300; i++) {\r\n      cart[i] = 0;\r\n    }\r\n    return cart;\r\n  };\r\n\r\n  const [cartItems, setCartItems] = useState(getDefaultCart());\r\n\r\n  useEffect(() => {\r\n    fetch(\"http://localhost:4000/allproducts\")\r\n      .then((res) => res.json())\r\n      .then((data) => setProducts(data));\r\n\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:4000/getcart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"auth-token\": `${localStorage.getItem(\"auth-token\")}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(),\r\n      })\r\n        .then((resp) => resp.json())\r\n        .then((data) => {\r\n          setCartItems(data);\r\n        });\r\n    }\r\n  }, []);\r\n\r\n  const getTotalCartAmount = () => {\r\n    let totalAmount = 0;\r\n    for (const item in cartItems) {\r\n      if (cartItems[item] > 0) {\r\n        let itemInfo = products.find((product) => product.id === Number(item));\r\n\r\n        if (itemInfo && itemInfo.new_price) {\r\n          totalAmount += cartItems[item] * itemInfo.new_price;\r\n        }\r\n      }\r\n    }\r\n    return totalAmount;\r\n  };\r\n\r\n  const getTotalCartItems = () => {\r\n    let totalItem = 0;\r\n    for (const item in cartItems) {\r\n      if (cartItems[item] > 0) {\r\n        totalItem += cartItems[item];\r\n      }\r\n    }\r\n    return totalItem;\r\n  };\r\n\r\n  const addToCart = (itemId) => {\r\n    console.log(\"Adding to cart:\", itemId);\r\n    setCartItems((prev) => ({ ...prev, [itemId]: prev[itemId] + 1 }));\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:4000/addtocart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"auth-token\": `${localStorage.getItem(\"auth-token\")}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ itemId: itemId }),\r\n      })\r\n        .then((resp) => {\r\n          if (!resp.ok) {\r\n            throw new Error(`HTTP error! Status: ${resp.status}`);\r\n          }\r\n          return resp.json();\r\n        })\r\n        .then((data) => {\r\n          console.log(data);\r\n          if (data.success) {\r\n            \r\n          } else {\r\n            \r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        \r\n        });\r\n    }\r\n  };\r\n\r\n  const removeFromCart = (itemId) => {\r\n    console.log(\"Removing from cart:\", itemId);\r\n    setCartItems((prev) => ({ ...prev, [itemId]: prev[itemId] - 1 }));\r\n    if (localStorage.getItem(\"auth-token\")) {\r\n      fetch(\"http://localhost:4000/removefromcart\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          Accept: \"application/json\",\r\n          \"auth-token\": `${localStorage.getItem(\"auth-token\")}`,\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ itemId: itemId }),\r\n      })\r\n        .then((resp) => resp.json())\r\n        .then((data) => {\r\n          console.log(data);\r\n        });\r\n    }\r\n  };\r\n\r\n  const contextValue = {\r\n    products,\r\n    getTotalCartItems,\r\n    cartItems,\r\n    addToCart,\r\n    removeFromCart,\r\n    getTotalCartAmount,\r\n  };\r\n\r\n  return (\r\n    <ShopContext.Provider value={contextValue}>\r\n      {props.children}\r\n    </ShopContext.Provider>\r\n  );\r\n};\r\n\r\nexport default ShopContextProvider;\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}